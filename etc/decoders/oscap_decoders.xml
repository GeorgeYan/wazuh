<!--
  -  OpenSCAP decoder
  -  v1.0 2016/10/13
  -  Created by Wazuh, Inc. <ossec@wazuh.com>.
  -  This program is a free software; you can redistribute it and/or modify it under the terms of GPLv2
-->

<!--
OpenSCAP
Logs from syslog.
-->
<decoder name="oscap">
    <program_name>oscap</program_name>
</decoder>

<!--
OpenSCAP
Logs from wodle
-->
<decoder name="oscap">
  <prematch>oscap: </prematch>
</decoder>


<!--
Rule Result: xccdf
oscap: msg: "xccdf-result", content: "ssg-centos-7-ds.xml", title: "Ensure Default Password Is Not Used", benchmark-id: "xccdf_org.ssgproject.content_benchmark_RHEL-7", profile-id: "xccdf_org.ssgproject.content_profile_common", profile-title: "Common Profile for General-Purpose Systems", severity: "medium", result: "notselected", id: "xccdf_org.ssgproject.content_rule_snmpd_not_default_password", oval: "oval:ssg:def:769", reference: "CCE-RHEL7-CCE-TBD".
-->
<decoder name="oscap-wodle-xccdf-result">
  <parent>oscap</parent>
  <prematch offset="after_parent">^msg: "xccdf-result", </prematch>
  <regex offset="after_prematch">^content: "(\.*)", title: "(\.*)", benchmark-id: "(\.*)", profile-id: "(\.*)", profile-title: "(\.*)", severity: "(\.*)", result: "(\.*)", id: "(\.*)", oval: "(\.*)", reference: "(\.*)".$</regex>
  <order>oscap.content, oscap.check.title, oscap.benchmark.id, oscap.profile.id, oscap.profile.title, oscap.check.severity, oscap.check.result, oscap.check.id, oscap.check.oval.id, oscap.check.reference</order>
</decoder>

<!--
Rule Result: oval
oscap: msg: "oval-result", content: "com.ubuntu.xenial.cve.oval.xml", id: "oval:com.ubuntu.xenial:def:20022439000", title: "CVE-2002-2439 on Ubuntu 16.04 LTS (xenial) - low.", profile-title: "vulnerability", result: "fail", reference: "CVE-2002-2439".
-->
<decoder name="oscap-wodle-oval-result">
  <parent>oscap</parent>
  <prematch offset="after_parent">^msg: "oval-result", </prematch>
  <regex offset="after_prematch">^content: "(\.*)", id: "(\.*)", title: "(\.*)", profile-title: "(\.*)", result: "(\.*)", reference: "(\.*)".$</regex>
  <order>oscap.content, oscap.check.oval.id, oscap.check.title, oscap.profile.title, oscap.check.result, oscap.reference</order>
</decoder>


<!--
Report overview: xccdf
oscap: msg: "xccdf-overview", content: "cve-redhat-7-ds.xml", benchmark-id: "xccdf_org.ssgproject.content_benchmark_RHEL-7", profile-id: "xccdf_org.ssgproject.content_profile_common", profile-title: "Common Profile for General-Purpose Systems", score: "62.500000".
-->
<decoder name="oscap-wodle-xccdf-overview">
  <parent>oscap</parent>
  <prematch offset="after_parent">^msg: "xccdf-overview", </prematch>
  <regex offset="after_prematch">^content: "(\.*)", benchmark-id: "(\.*)", profile-id: "(\.*)", profile-title: "(\.*)", score: "(\.*)".$</regex>
  <order>oscap.content, oscap.benchmark.id, oscap.profile.id, oscap.profile.title, oscap.score</order>
</decoder>

<!--
Report overview: oval
oscap: msg: "oval-overview", content: "com.ubuntu.xenial.cve.oval.xml", score: "48.19".
-->
<decoder name="oscap-wodle-oval-overview">
  <parent>oscap</parent>
  <prematch offset="after_parent">^msg: "oval-overview", </prematch>
  <regex offset="after_prematch">^content: "(\.*)", score: "(\.*)".$</regex>
  <order>oscap.content, oscap.score</order>
</decoder>


<!--
Apr 12 10:50:32 centos oscap: Evaluation started. Content: /usr/share/xml/scap/ssg/content/ssg-centos7-ds.xml, Profile: xccdf_org.ssgproject.content_profile_standard.
-->
<decoder name="oscap-eval-start">
    <parent>oscap</parent>
    <prematch offset="after_parent">^Evaluation started. </prematch>
    <regex offset="after_prematch">^Content: (\S+), Profile: (\S+).$</regex>
    <order>oscap.content, oscap.profile</order>
</decoder>

<!--
Apr 12 10:50:42 centos oscap: Evaluation finished. Return code: 0, Base score 100.000000.
-->
<decoder name="oscap-eval-finish">
    <parent>oscap</parent>
    <prematch offset="after_parent">^Evaluation finished. </prematch>
    <regex offset="after_prematch">^Return code: (\d+), Base score (\S+).</regex>
    <order>oscap.return_code, oscap.score</order>
</decoder>
